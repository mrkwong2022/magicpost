import{$ as l,c as e,s as a,o as t,e as u,f as s,J as n,K as o,F as d,h as r,g as i,t as m,by as c,aa as p,i as b,w as v,j as f,l as w,u as V,a as g,V as h,v as _,d as y,a5 as U,M as k,k as j,af as x,a7 as A,bz as C,bA as $,a8 as E,P as H,a9 as L,a3 as M,a4 as O}from"./wbs-CbbGGF9c.js";import{E as S,a as T}from"./el-tab-pane-7c8paWZP.js";import{a as z,E as F}from"./el-checkbox-t6DShoFv.js";/* empty css                          */import{E as Z}from"./el-switch-Bk0fvxZC.js";import"./strings-lvuBHTJ0.js";import"./index-DJzQTYa5.js";const B={class:"wb-tags-ctrl"},D={key:0,class:"tag-items"},J={class:"vam ib"},K=["onClick","data-del-val"],q=["placeholder"],I=l({__name:"wbsHtmlTags",props:{modelValue:{type:[String,Array],default:""},attrs:{type:Object,default:()=>({mode:!1,placeholder:"",maxLength:20})},all:{type:Array,default:()=>[]},rule:{type:String,default:""},wb_e:{type:Function,default:()=>""}},emits:["update:modelValue"],setup(l,{emit:b}){const v=l,f=b,w=e(""),V=e([]);e(v.attrs.mode??!1);const g=a((()=>v.attrs.placeholder||v.wb_e("请输入标签"))),h=a({get:()=>V.value.join(","),set:l=>{f("update:modelValue",l)}});function _(l){13===l.keyCode&&y()}function y(l=""){if(""===(l=l.trim()||w.value))return!1;if(!(l=l.replaceAll(/(^,)|(,$)/gi,"")).includes(","))return v.rule&&!new RegExp(v.rule).test(l)?(p.warning(v.wb_e("标签格式不正确")),w.value="",!1):v.all.includes(l)?(p.warning(v.wb_e("标签已预设，无需重复添加")),w.value="",!1):V.value.includes(l)?(p.warning(v.wb_e("已存在")),w.value="",!1):(V.value.push(l),h.value=V.value.join(","),w.value="",!1);l.split(",").forEach((l=>{l.trim()&&y(l)}))}return t((()=>{v.modelValue&&(V.value=Array.isArray(v.modelValue)?v.modelValue:v.modelValue.split(","))})),(l,e)=>(s(),u("label",B,[V.value.length?(s(),u("div",D,[(s(!0),u(d,null,r(V.value,((l,e)=>(s(),u("div",{class:"tag-item",key:e},[i("span",J,m(l),1),i("a",{class:"del",onClick:l=>{return a=e,V.value.splice(a,1),h.value=V.value.join(","),void p(v.wb_e("已移除"));var a},"data-del-val":l},null,8,K)])))),128))])):n("",!0),o(i("input",{class:"wb-tag-input",onKeyup:_,"onUpdate:modelValue":e[0]||(e[0]=l=>w.value=l),type:"text",placeholder:g.value},null,40,q),[[c,w.value]])]))}},[["__scopeId","data-v-e069cc75"]]),N={class:"selector-bar"},P=["innerHTML"],R={__name:"wbSelectorBar",props:{modelValue:{type:Array,default:()=>[]},items:{type:Array,default:()=>[]},format:{type:Boolean,default:!1},wb_e:{type:Function,default:()=>{}}},emits:["update:modelValue"],setup(l,{emit:n}){const o=l,c=n,p=e(!1),V=e(!1),g=a({get:()=>o.modelValue,set:l=>{c("update:modelValue",l)}});function h(l){g.value=l?o.items:[],V.value=!1}function _(l){return o.format?"&lt;"+l+"&gt;":l}function y(l){let e=l.length;p.value=e===o.items.length,V.value=e>0&&e<o.items.length}return t((()=>{p.value=g.value.length===o.items.length,V.value=0!=g.value.length&&g.value.length!=o.items.length})),(e,a)=>{const t=z,n=F;return s(),u("div",N,[b(t,{indeterminate:V.value,modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=l=>p.value=l),onChange:h},{default:v((()=>[f(m(l.wb_e("全选")),1)])),_:1},8,["indeterminate","modelValue"]),b(n,{modelValue:g.value,"onUpdate:modelValue":a[1]||(a[1]=l=>g.value=l),onChange:y},{default:v((()=>[(s(!0),u(d,null,r(l.items,((l,e)=>(s(),w(t,{value:l,key:e},{default:v((()=>[i("span",{innerHTML:_(l)},null,8,P)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])}}},G={class:"wbs-content"},Q={class:"wbs-main"},W={class:"opt-function-hd"},X={class:"func-name"},Y=["innerHTML"],ll={class:"mt"},el={class:"ml ib"},al={key:0,class:"wbs-form-table"},tl={class:"w8em"},ul={class:"ml"},sl={class:"description mt"},nl={class:"wbs-form-table"},ol={class:"row w8em"},dl={class:"description mt"},rl={class:"wbs-form-table"},il={class:"row w8em"},ml={class:"description mt"},cl={class:"wbs-form-table"},pl={class:"w8em"},bl={class:"description mt"},vl={class:"wbs-form-table"},fl={class:"w8em"},wl={class:"info"},Vl={class:"wbs-form-table"},gl={class:"w8em"},hl={class:"ml"},_l={class:"description mt"},yl={__name:"Clean",setup(l){const{wbsCnf:c}=V(),{wb_e:F}=g(c),B=e(0),D=e(!1);e(c.is_pro);const J=e(""),K=e(""),q=h({}),N=h({tags:{},attr:{},format:{},custom:{}}),P=h({});function yl(){if(!J.value)return!1;N.txt_replace.push({s:J.value,r:K.value,c:0}),J.value="",K.value=""}function Ul(){M.getData({op:"cht_setting"}).then((l=>{Object.assign(q,l.cnf),Object.assign(N,l.opt),Object.assign(P,function(){const l=q.tags,e={};for(let a in l)e[a]=l[a].filter((function(l){return N.tags&&N.tags.includes(l)}));return e}()),O((()=>{B.value=0})),D.value=!0}))}function kl(l){let e=N,a=[];for(let u in P)a=a.concat(P[u]);e.tags=a,e.re_txt=JSON.stringify(e.txt_replace);const t={op:"cht_update",opt:e};M.saveData(t).then((e=>{p.success(F("设置保存成功")),B.value=0,l&&l()}))}const jl=a((()=>{let l=[];const e=q.tags||{};for(let a in e)l=l.concat(e[a]);return l})),xl=a((()=>q.attr));return _(N,(()=>{B.value++}),{deep:!0}),t((()=>{Ul()})),(l,e)=>{const a=Z,t=R,p=I,V=S,g=z,h=x,_=A,M=T,O=E,Ul=L,Al=y("wbs-ctrl-bar"),Cl=U;return s(),u("div",G,[o((s(),u("div",{class:k(["wbs-content-inner",{"wb-page-loaded":D.value}])},[i("div",Q,[i("div",W,[i("h3",X,[i("strong",null,m(j(F)("内容清理")),1)]),i("div",{class:"func-desc",innerHTML:j(F)("清理文章中的无用内容，包括标签、属性、内容等。")},null,8,Y),i("div",ll,[b(a,{modelValue:N.switch,"onUpdate:modelValue":e[0]||(e[0]=l=>N.switch=l),"active-value":"1","inactive-value":"0"},null,8,["modelValue"]),i("span",el,m("1"==N.switch?j(F)("功能开启"):j(F)("功能关闭")),1)])]),D.value?(s(),u("table",al,[i("tbody",null,[i("tr",null,[i("th",tl,m(j(F)("古腾堡")),1),i("td",null,[b(a,{modelValue:N.gtb,"onUpdate:modelValue":e[1]||(e[1]=l=>N.gtb=l),"active-value":"1","inactive-value":"0"},null,8,["modelValue"]),i("span",ul,m(1==N.gtb?j(F)("支持开启古腾堡"):j(F)("插件已强制关闭古腾堡")),1),i("div",sl,m(j(F)("* 当前功能在古腾堡编辑器下无效。需要使用当前功能，请关闭古腾堡编辑器。")),1)])])])])):n("",!0),D.value?(s(),w(M,{key:1,"tab-position":j(c).is_mobile?"top":"left"},{default:v((()=>[b(V,{label:j(F)("标签删除")},{default:v((()=>[i("table",nl,[i("tbody",null,[i("tr",null,[i("th",ol,m(j(F)("常见标签")),1),i("td",null,[b(t,{items:q.tags.normal,modelValue:P.normal,"onUpdate:modelValue":e[2]||(e[2]=l=>P.normal=l),format:!0,wb_e:j(F)},null,8,["items","modelValue","wb_e"])])]),i("tr",null,[i("th",null,m(j(F)("表格标签")),1),i("td",null,[b(t,{items:q.tags.table,modelValue:P.table,"onUpdate:modelValue":e[3]||(e[3]=l=>P.table=l),format:!0,wb_e:j(F)},null,8,["items","modelValue","wb_e"])])]),i("tr",null,[i("th",null,m(j(F)("列表标签")),1),i("td",null,[b(t,{items:q.tags.list,modelValue:P.list,"onUpdate:modelValue":e[4]||(e[4]=l=>P.list=l),format:!0,wb_e:j(F)},null,8,["items","modelValue","wb_e"])])]),i("tr",null,[i("th",null,m(j(F)("其他标签")),1),i("td",null,[b(t,{items:q.tags.other,modelValue:P.other,"onUpdate:modelValue":e[5]||(e[5]=l=>P.other=l),format:!0,wb_e:j(F)},null,8,["items","modelValue","wb_e"])])]),i("tr",null,[i("th",null,m(j(F)("自定义")),1),i("td",null,[b(p,{modelValue:N.custom.tags,"onUpdate:modelValue":e[6]||(e[6]=l=>N.custom.tags=l),all:jl.value,format:!0,wb_e:j(F),rule:"^[a-zA-Z0-9_-]+$"},null,8,["modelValue","all","wb_e"]),i("div",dl,m(j(F)("* 无需输入<> </>，输入标签名称即可，多个标签以空格或回车键分隔。")),1)])])])])])),_:1},8,["label"]),b(V,{label:j(F)("标签属性删除")},{default:v((()=>[i("table",rl,[i("tbody",null,[i("tr",null,[i("th",il,m(j(F)("常见标签属性")),1),i("td",null,[b(t,{items:q.attr,modelValue:N.attr,"onUpdate:modelValue":e[7]||(e[7]=l=>N.attr=l),wb_e:j(F)},null,8,["items","modelValue","wb_e"])])]),i("tr",null,[i("th",null,m(j(F)("自定义")),1),i("td",null,[b(p,{modelValue:N.custom.attr,"onUpdate:modelValue":e[8]||(e[8]=l=>N.custom.attr=l),all:xl.value,format:!1,wb_e:j(F),rule:"^[a-zA-Z0-9_-]+$"},null,8,["modelValue","all","wb_e"]),i("div",ml," * "+m(j(F)("多个标签属性以空格或者回车键分隔")),1)])])])])])),_:1},8,["label"]),b(V,{label:j(F)("标签及内容删除")},{default:v((()=>[i("table",cl,[i("tbody",null,[i("tr",null,[i("th",pl,m(j(F)("自定义")),1),i("td",null,[b(p,{modelValue:N.stag,"onUpdate:modelValue":e[9]||(e[9]=l=>N.stag=l),all:N.stag,format:!1,wb_e:j(F),rule:"^[a-zA-Z0-9_-]+$"},null,8,["modelValue","all","wb_e"]),i("div",bl,m(j(F)("* 无需输入<> & </>，输入标签名称即可，多个标签以空格或回车键分隔")),1)])])])])])),_:1},8,["label"]),b(V,{label:j(F)("优化选项")},{default:v((()=>[i("table",vl,[i("tbody",null,[i("tr",null,[i("th",fl,m(j(F)("设置选项")),1),i("td",wl,[(s(!0),u(d,null,r(q.format,((l,e)=>(s(),w(g,{key:"format"+e,"true-value":"1","false-value":"0",modelValue:N.format[e],"onUpdate:modelValue":l=>N.format[e]=l},{default:v((()=>[f(m(j(F)(l)),1)])),_:2},1032,["modelValue","onUpdate:modelValue"])))),128))])])])])])),_:1},8,["label"]),b(V,{label:j(F)("搜索替换")},{default:v((()=>[i("table",Vl,[i("tbody",null,[i("tr",null,[i("th",gl,m(j(F)("设置替换项目")),1),i("td",null,[i("ul",null,[(s(!0),u(d,null,r(N.txt_replace,((l,e)=>(s(),u("li",{class:k({mt:e>0}),key:"replace"+e},[b(h,{class:"wbs-input-short wbs-input-underline",modelValue:l.s,"onUpdate:modelValue":e=>l.s=e},null,8,["modelValue","onUpdate:modelValue"]),f(" "+m(j(F)("替换"))+" ",1),b(h,{class:"wbs-input-short wbs-input-underline",modelValue:l.r,"onUpdate:modelValue":e=>l.r=e},null,8,["modelValue","onUpdate:modelValue"]),i("label",hl,[b(a,{modelValue:l.c,"onUpdate:modelValue":e=>l.c=e,"active-value":"1","inactive-value":"0"},null,8,["modelValue","onUpdate:modelValue"])]),b(_,{class:"ml",icon:j(C),circle:"",onClick:l=>function(l){return N.txt_replace.splice(l,1),!1}(e)},null,8,["icon","onClick"])],2)))),128))]),i("div",{class:k({mt:N.txt_replace.length>0})},[b(h,{class:"wbs-input-short wbs-input-underline",placeholder:j(F)("搜索内容"),modelValue:J.value,"onUpdate:modelValue":e[10]||(e[10]=l=>J.value=l)},null,8,["placeholder","modelValue"]),f(" "+m(j(F)("替换"))+" ",1),b(h,{class:"wbs-input-short wbs-input-underline",placeholder:j(F)("替换内容"),modelValue:K.value,"onUpdate:modelValue":e[11]||(e[11]=l=>K.value=l)},null,8,["placeholder","modelValue"]),b(_,{class:"ml",onClick:yl,icon:j($)},{default:v((()=>[i("span",null,m(j(F)("增加")),1)])),_:1},8,["icon"])],2),i("div",_l,[i("ul",null,[i("li",null,m(j(F)("搜索替换支持正则表达式，参考如下：")),1),i("li",null,m(j(F)('（1）使用*代表任意查找字符，括号(匹配内容)可在替换内容用$1引用。搜索填写 <div class="post-title">(*)</div> 替换填写 <h1>$1</h1>')),1),i("li",null,m(j(F)("（2）<h4> 替换 <strong>；则搜索填写 <(/?)h4 替换填写 <$1strong")),1),i("li",null,m(j(F)("（3）wp-content/uploads/年/月/ 替换 wp-content/uploads/年-月/ 搜索填写\n                          wp-content/uploads/(d{4})/(d{2})/ 替换填写 wp-content/uploads/$1-$2/")),1)])])])])])])])),_:1},8,["label"])])),_:1},8,["tab-position"])):n("",!0),o(b(O,{class:"mt"},null,512),[[H,D.value]])]),j(c).is_pro?n("",!0):(s(),w(Ul,{key:0})),b(Al,{changed:B.value,wb_e:j(F),onSubmit:kl},null,8,["changed","wb_e"])],2)),[[Cl,!D.value]])])}}};export{yl as default};
