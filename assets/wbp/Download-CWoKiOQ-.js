import{u as l,a as e,a6 as a,c as s,V as t,v as u,o,d as n,e as c,f as d,K as i,a5 as p,M as m,g as r,l as b,J as _,i as v,t as g,k as f,w as y,F as h,h as k,j as w,af as V,by as j,N as U,bz as C,P as E,a7 as O,bB as P,bC as D,bD as x,bE as z,a8 as J,a9 as M,a3 as N,a4 as S,ae as T,aa as F}from"./wbs-CbbGGF9c.js";import{E as H,_ as L}from"./GeneralForm-C8LWseM4.js";import{E as R}from"./el-link-DgJrFxMx.js";/* empty css                          */import{E as A,a as B}from"./el-checkbox-t6DShoFv.js";import{E as G}from"./el-switch-Bk0fvxZC.js";import"./el-popper-aeiKbmSs.js";import"./el-radio-jqbfmBTq.js";import"./el-select-Dy7NI8A6.js";import"./strings-lvuBHTJ0.js";const K={class:"wbs-content"},q={class:"wbs-main"},I={class:"opt-function-hd"},Q={class:"func-name"},W=["innerHTML"],X={class:"mt"},Y={class:"ml ib"},Z={key:0},$=["onUpdate:modelValue","placeholder"],ll=["onClick"],el={key:0,class:"ib ml-l"},al={key:1,class:"ib ml-l"},sl={key:1,class:"description"},tl={__name:"Download",setup(tl){const{wbsCnf:ul}=l(),{wb_e:ol}=e(ul);a();const nl=s(0),cl=s(!1),dl=s(ul.is_pro),il=t({}),pl=t({}),ml=s([]),rl=s(!1);function bl(l){const e={op:"dip_update",opt:il};N.saveData(e).then((e=>{e&&0==e.code?F.success(ol("设置保存成功")):F.error(e.desc||ol("设置保存失败")),nl.value=0,l&&l()}))}function _l(){il.dlt_custom.push({slug:"dlct_"+(new Date).getTime(),label:"",status:0})}function vl(){let l=!1;il.dlt_custom.forEach((e=>{e.label||(l=!0)})),l?T.alert(ol("请填写自定义下载方式名称"),ol("提示")):rl.value=!rl.value}function gl(){rl.value=!1}return u(il,(()=>{nl.value++}),{deep:!0}),o((()=>{N.getData({op:"dip_setting"}).then((l=>{Object.assign(il,l.opt),Object.assign(pl,l.cnf),dl.value&&l.opt.dlt_custom&&(ml.value=JSON.parse(JSON.stringify(l.opt.dlt_custom)),0===ml.value.length&&(rl.value=!0)),S((()=>{nl.value=0})),cl.value=!0}))})),(l,e)=>{const a=G,s=B,t=A,u=H,o=V,N=U,S=O,F=R,tl=L,fl=J,yl=M,hl=n("wbs-ctrl-bar"),kl=p;return d(),c("div",K,[i((d(),c("div",{class:m(["wbs-content-inner",{"wb-page-loaded":cl.value}])},[r("div",q,[r("div",I,[r("h3",Q,[r("strong",null,g(pl.label),1),e[6]||(e[6]=r("i",{class:"tag-pro"},"Pro",-1))]),r("div",{class:"func-desc",innerHTML:pl.description},null,8,W),r("div",X,[v(a,{modelValue:il.switch,"onUpdate:modelValue":e[0]||(e[0]=l=>il.switch=l),"active-value":"1","inactive-value":"0"},null,8,["modelValue"]),r("span",Y,g("1"==il.switch?f(ol)("功能开启"):f(ol)("功能关闭")),1)])]),v(tl,{class:"table-wp",modelValue:il,"onUpdate:modelValue":e[5]||(e[5]=l=>il=l),fields:pl.fields,wb_e:f(ol)},{custom:y((({field:a})=>["dl_type_items"==a.slug?(d(),b(u,{key:0,"data-slug":a.slug,label:a.label},{default:y((()=>[v(t,{modelValue:il.dl_type_items,"onUpdate:modelValue":e[1]||(e[1]=l=>il.dl_type_items=l)},{default:y((()=>[(d(!0),c(h,null,k(pl.dl_type_items,(l=>(d(),b(s,{key:l.slug,label:l.label,value:l.slug},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:2},1032,["data-slug","label"])):_("",!0),"supply_post_types"==a.slug?(d(),b(u,{key:1,"data-slug":a.slug,label:a.label},{default:y((()=>[v(t,{modelValue:il.supply_post_types,"onUpdate:modelValue":e[2]||(e[2]=l=>il.supply_post_types=l)},{default:y((()=>[(d(!0),c(h,null,k(pl.post_types,((l,e)=>(d(),b(s,{key:e,label:l,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:2},1032,["data-slug","label"])):_("",!0),"custom-download-type"==a.type?(d(),b(u,{key:2,"data-slug":a.slug,class:m({"with-sub-group":a.group})},{label:y((()=>[r("span",null,[w(g(a.label),1),e[7]||(e[7]=r("i",{class:"tag-pro"},"Pro",-1))])])),default:y((()=>[dl.value?(d(),c("div",Z,[(d(!0),c(h,null,k(il.dlt_custom,((l,e)=>i((d(),c("div",{class:m(["ib",{"ml-l":e>0}]),key:e},[rl.value?_("",!0):(d(),b(s,{key:0,modelValue:l.status,"onUpdate:modelValue":e=>l.status=e,"true-value":"1","false-value":"0"},{default:y((()=>[w(g(l.label),1)])),_:2},1032,["modelValue","onUpdate:modelValue"])),rl.value?(d(),b(o,{key:1,class:"w8em",modelValue:l.label,"onUpdate:modelValue":e=>l.label=e,placeholder:f(ol)("名称")},null,8,["modelValue","onUpdate:modelValue","placeholder"])):_("",!0),i(r("input",{type:"hidden",class:"w8em ml","onUpdate:modelValue":e=>l.slug=e,placeholder:f(ol)("英文标识")},null,8,$),[[j,l.slug]]),rl.value?(d(),c("span",{key:2,class:"ml ib",onClick:l=>function(l){T.confirm(ol("确认删除？"),ol("提示")).then((()=>{ml.value.filter((e=>e.slug==il.dlt_custom[l].slug)).length?il.dlt_custom[l].status=-1:il.dlt_custom.splice(l,1)}))}(e)},[v(N,{size:16},{default:y((()=>[v(f(C))])),_:1})],8,ll)):_("",!0)],2)),[[E,l.status>-1]]))),128)),i(r("div",{class:m(["ib",{"ml-l":il.dlt_custom.length>0}])},[v(S,{icon:f(P),size:"small",plain:"",type:"primary",onClick:_l},{default:y((()=>[w(g(f(ol)("添加")),1)])),_:1},8,["icon"])],2),[[E,rl.value]]),rl.value?il.dlt_custom.length>0?(d(),c("span",al,[v(S,{type:"success",icon:f(x),circle:"",onClick:vl},null,8,["icon"]),v(S,{icon:f(z),circle:"",onClick:gl},null,8,["icon"])])):_("",!0):(d(),c("span",el,[v(S,{onClick:e[3]||(e[3]=l=>rl.value=!0),icon:f(D),circle:""},null,8,["icon"])]))])):(d(),c("div",sl,[w(g(f(ol)("获取PRO版本即可配置更多下载方式。"))+", ",1),v(F,{type:"primary",onClick:e[4]||(e[4]=e=>l.doActivePro())},{default:y((()=>[w(g(f(ol)("激活PRO版")),1)])),_:1})]))])),_:2},1032,["data-slug","class"])):_("",!0)])),_:1},8,["modelValue","fields","wb_e"]),i(v(fl,{class:"mt"},null,512),[[E,cl.value]])]),f(ul).is_pro?_("",!0):(d(),b(yl,{key:0})),v(hl,{changed:nl.value,wb_e:f(ol),onSubmit:bl},null,8,["changed","wb_e"])],2)),[[kl,!cl.value]])])}}};export{tl as default};
