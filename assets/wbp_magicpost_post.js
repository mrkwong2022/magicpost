(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function n(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}function r(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||n(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function i(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function c(t){o(a,r,i,c,u,"next",t)}function u(t){o(a,r,i,c,u,"throw",t)}c(void 0)}))}}function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,l=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){l=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(t,e)||n(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(){c=function(){return e};var e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function f(t,e,n,r){var i=e&&e.prototype instanceof v?e:v,a=Object.create(i.prototype),c=new A(r||[]);return o(a,"_invoke",{value:E(t,n,c)}),a}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var p={};function v(){}function h(){}function y(){}var m={};s(m,a,(function(){return this}));var g=Object.getPrototypeOf,w=g&&g(g(j([])));w&&w!==n&&r.call(w,a)&&(m=w);var b=y.prototype=v.prototype=Object.create(m);function x(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function S(e,n){function i(o,a,c,u){var l=d(e[o],e,a);if("throw"!==l.type){var s=l.arg,f=s.value;return f&&"object"==t(f)&&r.call(f,"__await")?n.resolve(f.__await).then((function(t){i("next",t,c,u)}),(function(t){i("throw",t,c,u)})):n.resolve(f).then((function(t){s.value=t,c(s)}),(function(t){return i("throw",t,c,u)}))}u(l.arg)}var a;o(this,"_invoke",{value:function(t,e){function r(){return new n((function(n,r){i(t,e,n,r)}))}return a=a?a.then(r,r):r()}})}function E(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return C()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=L(a,n);if(c){if(c===p)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=d(t,e,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function L(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,L(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var o=d(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,p;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function j(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:C}}function C(){return{value:void 0,done:!0}}return h.prototype=y,o(b,"constructor",{value:y,configurable:!0}),o(y,"constructor",{value:h,configurable:!0}),h.displayName=s(y,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,s(t,l,"GeneratorFunction")),t.prototype=Object.create(b),t},e.awrap=function(t){return{__await:t}},x(S.prototype),s(S.prototype,u,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(f(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(b),s(b,l,"Generator"),s(b,a,(function(){return this})),s(b,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=j,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:j(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}var u={stringify:function(e){if("object"!=t(e))return"";var n=[];return Object.entries(e).forEach((function(t){var e=a(t,2),r=e[0],o=e[1];n.push("".concat(r,"=").concat(o))})),n.join("&")},getData:function(t){return i(c().mark((function e(){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:u.stringify(t)},e.prev=1,e.next=4,fetch(wb_magicpost_cnf.ajax_url,n);case 4:return r=e.sent,e.abrupt("return",r.json());case 8:e.prev=8,e.t0=e.catch(1),Promise.reject(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))()},saveData:function(t){return i(c().mark((function e(){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:u.stringify(t)},e.prev=1,e.next=4,fetch(wb_magicpost_cnf.ajax_url,n);case 4:return r=e.sent,e.abrupt("return",r.json());case 8:e.prev=8,e.t0=e.catch(1),Promise.reject(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))()},getText:function(t){return i(c().mark((function e(){var n,r;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:u.stringify(t)},e.prev=1,e.next=4,fetch(wb_magicpost_cnf.ajax_url,n);case 4:return r=e.sent,e.abrupt("return",r.text());case 8:e.prev=8,e.t0=e.catch(1),Promise.reject(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))()},getLocalStorage:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=localStorage.getItem(t);if(!n)return!1;try{return e?JSON.parse(n):JSON.parse(n).data}catch(e){localStorage.removeItem(t)}},setLocalStorage:function(t,e){var n={ver:(new Date).getTime(),data:e},r=JSON.stringify(n);localStorage.setItem(t,r)},on:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var o=e;3===o.length&&(o=[[document.documentElement]].concat(r(o))),"String"===o[0].constructor.name?o[0]=r(document.querySelectorAll(o[0])):o[0].forEach?o[0]=r(o[0]):o[0]=[o[0]],"String"!==o[2].constructor.name&&(o[2].forEach?o[2]=r(o[2]):o[2]=[o[2]]);var i=a(o,4),c=i[0],u=i[1],l=i[2],s=i[3],f=u.split(" "),d=function(t){var e;"String"===l.constructor.name?e=t.target.closest(l):e=a(l.filter((function(e){return e===t.target||e.contains(t.target)})),1)[0];e&&(t.relatedElements=c,s.call(e,t,e))};return c.forEach((function(t){f.forEach((function(e){t.addEventListener(e,d,!0)}))})),d},closest:function(t,e){for(var n=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector;t&&!n.call(t,e);)t=t.parentElement;return t},i18n:function(t){return wb_magicpost_cnf.i18n[t]}},l=function(t){return function(t){for(var e=(new TextEncoder).encode(t),n=[],r=0;r<256;r++){for(var o=r,i=0;i<8;i++)o=1&o?3988292384^o>>>1:o>>>1;n[r]=o}for(var a=-1,c=0;c<e.length;c++)a=a>>>8^n[255&(a^e[c])];return(-1^a)>>>0}(t).toString(16).padStart(8,"0")},s=function(){return window.wb_i18n_magicpost||{}},f=function(t){return s()[l(t)]||"{".concat(t,"}")},d=u.on,p=u.setLocalStorage,v=(u.getLocalStorage,u.closest),h=(u.getData,u.saveData,document),y="getElementsByClassName",m=function(t){return h.querySelectorAll(t)},g="OK",w="Cancel",b=["dialog","toast","loading","iframe"],x={type:0,mask:!0,maskClose:!0,closebtn:!0,whenBtnClickClose:!0,fixed:!0,anim:"def"},S={extend:function(t,e){var n="object"==typeof e?JSON.parse(JSON.stringify(e)):JSON.parse(JSON.stringify(x));for(var r in t)n[r]=t[r];return n},timer:{},end:{},touch:function(t,e){t.addEventListener("click",(function(t){e.call(this,t)}),!1)}},E=0,L=["wbui"],_=function(t){this.config=S.extend(t),this.view()};_.prototype.view=function(){var t=this,e=t.config,n=h.createElement("div"),r="object"==typeof e.content,o="string"==typeof e.type?e.type:L[0]+"-"+b[e.type||0];t.id=n.id=L[0]+E,n.setAttribute("class",L[0]+" "+o),n.setAttribute("index",E);var i,a,c=(i="object"==typeof e.title,e.title?'<h3 class="wbui-title'+(i?" "+e.title[1]:"")+'">'+(i?e.title[0]:e.title)+"</h3>":""),u=(a="object"==typeof e.closebtn,e.closebtn?'<a class="wbui-close'+(a?" "+e.closetype[1]:"")+'"><i></i></a>':""),l=function(){"string"==typeof e.btn&&(e.btn=[e.btn]);var t,n=(e.btn||[]).length;return 0!==n&&e.btn?(t='<span yes type="1">'+e.btn[0]+"</span>",2===n&&(t='<span no type="0">'+e.btn[1]+"</span>"+t),'<div class="wbui-btn">'+t+"</div>"):""}();if(e.fixed||(e.top=e.hasOwnProperty("top")?e.top:100,e.style=e.style||"",e.style+=" top:"+(h.body.scrollTop+e.top)+"px"),2===e.type&&(e.content='<i></i><i class="wbui-load"></i><i></i><p>'+(e.content||"")+"</p>"),3===e.type){e.content=r?e.content:[e.content||"","auto"];e.content='<iframe scrolling="'+(e.content[1]||"auto")+'" allowtransparency="true" id="'+b[3]+E+'" name="'+b[3]+E+'" onload="this.className=\'\';" class="wbui-load" frameborder="0" src="'+e.content[0]+'"></iframe>'}if(e.skin&&(e.anim="fade"),"msg"===e.skin&&(e.mask=e.closebtn=!1,e.time=2),n.innerHTML=(e.mask?"<div "+("string"==typeof e.mask?'style="'+e.mask+'"':"")+' class="wbui-mask"></div>':"")+'<div class="wbui-main" '+(e.fixed?"":'style="position:static;"')+'><div class="wbui-section"><div class="wbui-child '+(e.skin?"wbui-"+e.skin+" ":"")+(e.className?e.className:"")+" "+(e.anim?"wbui-anim-"+e.anim:"")+'" '+(e.style?'style="'+e.style+'"':"")+">"+c+'<div class="wbui-cont">'+e.content+"</div>"+l+(e.closebtn?u:"")+"</div></div></div>",!e.type||2===e.type){var s=h[y](L[0]+b[e.type]);s.length>=1&&k.close(s[0].getAttribute("index"))}document.body.appendChild(n);var f=t.elem=m("#"+t.id)[0];e.success&&e.success(f),t.index=E++,t.action(e,f)},_.prototype.action=function(t,e){var n=this;t.time&&(S.timer[n.index]=setTimeout((function(){k.close(n.index)}),1e3*t.time));var r=function(){0==this.getAttribute("type")?(t.no&&t.no(),k.close(n.index)):(t.yes&&t.yes(n.index),t.whenBtnClickClose&&k.close(n.index))};if(t.btn)for(var o=e[y]("wbui-btn")[0].children,i=o.length,a=0;a<i;a++)S.touch(o[a],r);if(t.mask&&t.maskClose){var c=e[y]("wbui-mask")[0];S.touch(c,(function(){k.close(n.index,t.end)}))}if(t.closebtn){var u=e[y]("wbui-close")[0];S.touch(u,(function(){k.close(n.index,t.end)}))}t.end&&(S.end[n.index]=t.end)};const k={v:"1.0.5",index:E,open:function(t){return new _(t||{}).index},alert:function(t,e){var n="function"==typeof e,r=S.extend({content:t,btn:g});return r=n?S.extend({yes:e},r):S.extend(e,r),k.open(r)},confirm:function(t,e,n,r){var o="function"==typeof e,i=S.extend({content:t,btn:[g,w]});return i=o?S.extend({yes:e,no:n},i):S.extend(e,i),k.open(i)},toast:function(t,e){var n="function"==typeof e,r=S.extend({type:1,content:t,mask:0,closebtn:0,time:2});return r=n?S.extend({end:e},r):S.extend(e,r),k.open(r)},loading:function(t){var e="function"==typeof t,n=S.extend({type:2,content:0,mask:0,maskClose:0,closebtn:0});return n=e?S.extend({end:t},n):S.extend(t,n),k.open(n)},iframe:function(t,e,n,r){var o="function"==typeof e,i=S.extend({type:3,content:t,mask:0});return i=o?S.extend({yes:e,no:n},i):S.extend(e,i),k.open(i)},close:function(t){var e=m("#"+L[0]+t)[0];e&&(e.innerHTML="",h.body.removeChild(e),clearTimeout(S.timer[t]),delete S.timer[t],"function"==typeof S.end[t]&&S.end[t](),delete S.end[t])},closeAll:function(){for(var t=h[y](L[0]),e=0,n=t.length;e<n;e++)k.close(0|t[0].getAttribute("index"))}};var A={init:function(){var t=this,e=document.querySelector("#wb-cls-tag-btn");e&&e.addEventListener("click",(function(){k.open({className:"wbui-cht",title:f("本次优化参数设置"),content:wbcht_cnf.data,btn:[f("执行优化")],success:function(){var t=document.querySelector("#J_wbTabCHT"),e=document.querySelectorAll("#J_wbTabCHT .tab-cont");d(t,"click",".tab-nav-item",(function(n,r){t.querySelector(".tab-nav-item.current").classList.remove("current"),t.querySelector(".tab-cont.current").classList.remove("current"),console.log(r);var o=r.dataset.index;r.classList.add("current"),e[o].classList.add("current")}))},yes:function(){var e=document.querySelector("#J_wbTabCHT");e&&t.doAction(e)}})}))},doAction:function(t){var e=this.getContent();if(e){var n=[],r=t.querySelectorAll(".wb-cls-tag:checked");if(Array.prototype.forEach.call(r,(function(t){n.push(t.value)})),n.length>0){var o=n.join("|");if(console.log("tags",n),n&&e){var i=new RegExp("<("+o+")\\s[^>]*>","g"),a=new RegExp("<("+o+")>","g"),c=new RegExp("</("+o+")>","g");e=e.replace(i,"").replace(a,"").replace(c,"")}}var u=[],l=t.querySelectorAll(".wb-cls-attr:checked");if(Array.prototype.forEach.call(l,(function(t){u.push(t.value)})),u.length>0)for(var s="",d="",p=0;p<u.length;p++)d=u[p].replace("*","[a-zA-Z0-9_-]+"),s=new RegExp("<([^\\s]+.*?)\\s+"+d+'="[^"]*"([^>]*)>',"gi"),e=e.replace(s,(function(t){var e=new RegExp("\\s+"+d+'="[^"]*"',"gi");return t.replace(e,"")}));var v=[],h=t.querySelectorAll(".wb-cls-stag:checked");if(Array.prototype.forEach.call(h,(function(t){v.push(t.value)})),v.length>0){var y=v.join("|");if(console.log("stags",v),v&&e){var m=new RegExp("<("+y+")(\\s[^>]*)?>.*</("+y+")>","g");e=e.replace(m,"")}}var g=t.querySelectorAll(".wb-cls-format:checked");g.length&&Array.prototype.forEach.call(g,(function(t){var n=t.value;if("h2p"==n){var r=new RegExp("(</h[1-9]>)([^\n])","gi");e=e.replace(r,(function(t,e,n){return e+"\n"+n})),r=new RegExp("([^\n])(<h[1-9])","gi"),e=e.replace(r,(function(t,e,n){return e+"\n"+n}))}else if("img2img"==n||"img2p"==n){var o=new RegExp("(<img[^>]+>)([^\n])","gi");e=e.replace(o,(function(t,e,n){return e+"\n"+n})),o=new RegExp("([^\n])(<img)","gi"),e=e.replace(o,(function(t,e,n){return e+"\n"+n}))}else if("text-indent"==n){var i=new RegExp("(<p[^>]*>)[\n\\s]+","gi");e=e.replace(i,(function(t,e){return e})),i=new RegExp("(\n\\s+)([^\\s])","gi"),e=e.replace(i,(function(t,e,n){return"\n"+n})),i=new RegExp("(<p[^>]*>)(&nbsp;)+","gi"),e=e.replace(i,(function(t,e){return e}))}else if("p2p"==n){var a=new RegExp("(</p[^>]*>)([^\n])","gi");e=e.replace(a,(function(t,e,n){return e+"\n"+n})),a=new RegExp("([^\n])(<p)","gi"),e=e.replace(a,(function(t,e,n){return e+"\n"+n}))}}));var w=t.querySelectorAll(".cls-re-c:checked");w.length&&Array.prototype.forEach.call(w,(function(t){var n=t.parentNode.parentNode,r=n.querySelector(".cls-re-s").value,o=n.querySelector(".cls-re-r").value;if(r){r=r.replace("*",".*?");try{var i=new RegExp(r,"gi");e=e.replace(i,o)}catch(t){console.log(t)}}})),this.setContent(e,(function(){k.toast(f("清除成功"))}))}else k.toast(f("Magicpost: 未能识别内容"))},getContent:function(){var e=null!=("undefined"==typeof tinyMCE?"undefined":t(tinyMCE))&&tinyMCE.activeEditor;return e&&!e.hidden?e.getContent({format:"raw"}):null!=("undefined"==typeof wpActiveEditor?"undefined":t(wpActiveEditor))?document.querySelector("#"+wpActiveEditor).value:document.querySelector("#content")?document.querySelector("#content").value:""},setContent:function(e,n){var r=null!=("undefined"==typeof tinyMCE?"undefined":t(tinyMCE))&&tinyMCE.activeEditor;r&&!r.hidden?r.setContent(e,{format:"raw"}):null!=("undefined"==typeof wpActiveEditor?"undefined":t(wpActiveEditor))?document.querySelector("#"+wpActiveEditor).value=e:document.querySelector("#content")?document.querySelector("#content").value=e:console.log(f("Magicpost: 未能识别编辑器")),n&&n()}},j={wb_frame:null,init:function(){var t=document.querySelector("#J_MPDL_SWITCH"),e=document.querySelector("#J_MPDLMain");if(e){var n=document.querySelectorAll("[name=wb_dl_mode]"),r=document.querySelector("#J_WBDLSetPrice");n.length&&d(e,"change","[name=wb_dl_mode]",(function(t,e){var n=e.value;r&&r.classList[2==n?"add":"remove"]("active")}));var o=document.querySelector("#vk_price"),i=document.querySelector("#wb_down_price");o&&i&&o.addEventListener("change",(function(){var t=o.value;console.log("vk_price",t),i.value=t})),t&&t.addEventListener("change",(function(){var e=t.dataset.target,n=document.querySelector(e);t.checked?(t.setAttribute("data-value","true"),n.classList.add("active"),p("WB_MPDL_SWITCH",!0)):(t.setAttribute("data-value","false"),n.classList.remove("active"),p("WB_MPDL_SWITCH",!1))})),document.querySelectorAll(".section-upload .wbs-upload-btn").length&&this.uploadFiles(e);var a=/(https?:\/\/[a-z0-9_\.\/#&\?=-]+).+?码.+?([a-z0-9]+)/i;d(e,"blur",".wbmgp-dl-with-psw",(function(t,e){var n=e.value;if(n&&a.test(n)){var r=v(e,".wb-post-sitting-item").querySelector(".wbmgp-dl-psw"),o=n.match(a);o[1]&&(e.value=o[1]),o[2]&&r&&(r.value=o[2])}}))}},uploadFiles:function(t){var e=this;d(t,"click",".wbs-upload-btn",(function(t,n){var r=n.previousElementSibling,o=window.frame||e.wb_frame;o||((o=wp.media({multiple:!1})).on("select",(function(){var t=o.state().get("selection").toJSON()[0].url;r.value=t,r.focus()})),e.wb_frame=o),o.open()}))}};document.addEventListener("DOMContentLoaded",(function(){A.init(),j.init()}))})();