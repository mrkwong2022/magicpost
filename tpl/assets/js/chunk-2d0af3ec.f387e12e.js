(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0af3ec"],{"0e01":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:!t.isLoaded,expression:"!isLoaded"}],staticClass:"wbs-content-inner full",class:{"wb-page-loaded":t.isLoaded}},[a("div",{staticClass:"wbs-main"},[t.isLoaded?a("div",{staticClass:"wb-section setting-box"},[a("div",{staticClass:"sc-main"},[a("h3",{staticClass:"sc-title"},[t._v("原分类")]),a("div",{staticClass:"wbs-ctrl-bar"},[a("el-select",{staticClass:"ctrl-item w8em",attrs:{size:"small",placeholder:"文章类型",clearable:""},on:{change:t.changeType},model:{value:t.q.post_type,callback:function(e){t.$set(t.q,"post_type",e)},expression:"q.post_type"}},t._l(t.cnf.post_type,(function(t,e){return a("el-option",{key:"o-s-t-"+e,attrs:{label:t,value:e}})})),1),a("el-select",{staticClass:"ctrl-item w8em",attrs:{size:"small",placeholder:"文章状态",clearable:""},model:{value:t.q.post_status,callback:function(e){t.$set(t.q,"post_status",e)},expression:"q.post_status"}},t._l(t.post_status,(function(t,e){return a("el-option",{key:"o-s-p-"+e,attrs:{label:t,value:e}})})),1),a("el-select",{staticClass:"ctrl-item",attrs:{size:"small",placeholder:"文章分类",clearable:""},model:{value:t.q.cat,callback:function(e){t.$set(t.q,"cat",e)},expression:"q.cat"}},t._l(t.cat_list,(function(t){return a("el-option",{key:t.cat_ID,attrs:{label:"— ".repeat(1*t.lv)+t.name,value:t.cat_ID}})})),1),a("el-select",{staticClass:"ctrl-item w8em",attrs:{size:"small",placeholder:"包含范围"},model:{value:t.q.query_child,callback:function(e){t.$set(t.q,"query_child",e)},expression:"q.query_child"}},t._l({lv1:"仅当前分类",lvn:"含子分类"},(function(t,e){return a("el-option",{key:"o-s-pc-"+e,attrs:{label:t,value:e}})})),1),a("el-input",{staticClass:"ctrl-item wbs-input-short",attrs:{clearable:"",size:"small",placeholder:"请输入内容"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchPost.apply(null,arguments)}},model:{value:t.q.keyword,callback:function(e){t.$set(t.q,"keyword",e)},expression:"q.keyword"}}),a("el-button",{staticClass:"ctrl-item",attrs:{type:"primary",size:"small"},on:{click:t.searchPost}},[t._v("搜索")]),a("div",{staticClass:"switch-btn align-right",on:{click:t.toggle_panel}},[t.isExpanded?a("div",[a("i",{staticClass:"el-icon-arrow-up"}),t._v(" "),a("span",[t._v("收起面板")])]):a("div",[a("i",{staticClass:"el-icon-search"}),t._v(" "),a("span",[t._v("筛选")])])])],1),a("div",{staticClass:"log-box"},[a("el-table",{ref:"sourceDataTable",staticClass:"wbs-table mt",staticStyle:{width:"100%"},attrs:{data:t.list},on:{"selection-change":t.handlePostSelection}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"文章名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{"data-label":"文章名称"}},[a("span",[t._v(t._s(e.row.post_title))])])]}}],null,!1,3083893248)}),a("el-table-column",{attrs:{label:"分类","class-name":"w20"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{"data-label":"分类"}},[a("span",[t._v(t._s(e.row.post_category.join("、")))])])]}}],null,!1,1463317371)}),a("el-table-column",{attrs:{label:"发布日期","class-name":"w20"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{attrs:{"data-label":"发布日期"}},[t._v(t._s(e.row.post_date))])]}}],null,!1,591987933)})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.list.length>0,expression:"list.length > 0"}],staticClass:"btns-bar with-ctrl-area"},[a("div",{staticClass:"wb-ctrl-area"},[a("el-select",{attrs:{size:"small",clearable:"",placeholder:"批量选择"},on:{change:t.batchOpChange},model:{value:t.batch_op,callback:function(e){t.batch_op=e},expression:"batch_op"}},[a("el-option",{attrs:{label:"清除选中",value:"none"}}),a("el-option",{attrs:{label:"选中当前页项",value:"page"}}),a("el-option",{attrs:{label:"选中所有结果项",value:"all"}})],1)],1),a("el-pagination",{attrs:{background:"",layout:t.$cnf.is_mobile?"pager, total, prev, next":"total, prev, pager, next, jumper","page-size":t.num,total:1*t.total,"pager-count":5,"current-page":t.page},on:{"current-change":t.nav_page}})],1)],1)]),a("div",{staticClass:"sc-side"},[a("h3",{staticClass:"sc-title"},[t._v("目标分类")]),a("div",{staticClass:"log-box"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.cat_list,"tooltip-effect":"dark"},on:{"selection-change":t.handleCatSelection}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"分类"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s("— ".repeat(1*e.row.lv))+" "+t._s(e.row.name)+" ")]}}],null,!1,1642187034)}),a("el-table-column",{attrs:{prop:"count",label:"文章数",width:"100"}})],1)],1)]),t.isPro?t._e():a("div",{staticClass:"getpro-mask"},[a("div",{staticClass:"mask-inner"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.doActivePro()}}},[t._v("获取PRO版本")]),a("p",{staticClass:"tips"},[t._v("* 激活PRO版本即可使用")])],1)])]):t._e(),a("wb-prompt",{directives:[{name:"show",rawName:"v-show",value:t.isLoaded,expression:"isLoaded"}],staticClass:"mt"}),t.$cnf.is_mobile?a("div",{staticClass:"mt"},[a("div",[a("el-button",{staticStyle:{display:"block",width:"100%"},attrs:{size:"medium"},on:{click:function(e){return t.setPost(1,"重置文章分类为目标分类")}}},[t._v("重置文章分类为目标分类")])],1),a("div",[a("el-button",{staticClass:"mt",staticStyle:{display:"block",width:"100%"},attrs:{size:"medium",type:"primary"},on:{click:function(e){return t.setPost(2,"添加目标分类至文章")}}},[t._v("添加目标分类至文章")])],1),a("div",[a("el-button",{staticClass:"mt",staticStyle:{display:"block",width:"100%"},attrs:{size:"medium",type:"success"},on:{click:function(e){return t.setPost(3,"将文章从目标分类移出")}}},[t._v("将文章从目标分类移出")])],1)]):t._e()],1),t.$cnf.is_mobile?t._e():a("div",{staticClass:"wbs-footer"},[a("div",{staticClass:"wbsf-inner"},[a("el-row",[a("el-button",{on:{click:function(e){return t.setPost(1,"重置文章分类为目标分类")}}},[t._v("重置文章分类为目标分类")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.setPost(2,"添加目标分类至文章")}}},[t._v("添加目标分类至文章")]),a("el-button",{attrs:{type:"success"},on:{click:function(e){return t.setPost(3,"将文章从目标分类移出")}}},[t._v("将文章从目标分类移出")])],1)],1)])])},l=[],o={name:"MagicPostMoveCategory",components:{},data(){const t=this;return{loading:0,wb_cnf:t.$cnf,isLoaded:!1,isPro:0,opt:{},cnf:{},q:{post_type:"post",post_status:"",cat:"",keyword:"",query_child:"lv1"},batch_op:"",list:[],total:0,page:1,num:30,selectPost:[],selectCat:[],post_status:{publish:"已发布",draft:"草稿",pending:"待审核",future:"计划"},isExpanded:!1}},computed:{cat_list(){const t=this;return t.cnf.cat_table[t.q.post_type]}},created(){const t=this;t.$cnf.is_pro&&t.$verify((e,a)=>{console.log([e,a]),e?t.isPro=e:(t.isPro=0,t.$cnf.is_pro=0)}),this.load_data()},methods:{batchOpChange(){const t=this;t.batch_op&&("none"==t.batch_op?t.$refs.sourceDataTable.clearSelection():(t.$refs.sourceDataTable.clearSelection(),t.$refs.sourceDataTable.toggleAllSelection()))},changeType(){console.log(this.q),this.q.cat=""},setPost(t,e){const a=this;if(a.selectPost.length<1)return void a.$wbui.toast("未选择文章");if(a.selectCat.length<1)return void a.$wbui.toast("未选择分类");if(!a.isPro)return;let s=[],l=[];a.selectPost.forEach((function(t,e){s.push(t.ID)})),a.selectCat.forEach((function(t,e){l.push(t.cat_ID)})),console.log(l),a.$wbui.confirm("确认"+e+"？",(function(){const e={_ajax_nonce:a.$cnf._ajax_nonce,action:a.$cnf.action.act,op:"move_cat",type:t,tax:a.cnf.cat_tax[a.q.post_type],post:s.join(","),cat:l.join(","),batch_op:a.batch_op};a.$api.saveData(e).then(t=>{a.$wbui.toast("设置成功"),a.batch_op="",a.$refs.sourceDataTable.clearSelection(),a.searchPost()})}))},handleCatSelection(t){this.selectCat=t},handlePostSelection(t){this.selectPost=t},nav_page(t){this.page=t,this.getData()},searchPost(){const t=this;t.page=1,t.getData()},getData(){const t=this;t.isPro&&(console.log(t.q),t.loading=t.$wbui.loading(),t.$api.getData({_ajax_nonce:t.$cnf._ajax_nonce,action:t.$cnf.action.act,op:"move_query",page:t.page,num:t.num,tax:t.cnf.cat_tax[t.q.post_type],q:t.q}).then(e=>{t.$wbui.close(t.loading),t.list=e["data"],t.total=e["total"]}))},load_data(){const t=this;t.$api.getData({_ajax_nonce:t.$cnf._ajax_nonce,action:t.$cnf.action.act,op:"move_cnf"}).then(e=>{if(t.cnf=e.cnf,t.cnf.post_type)for(let a in t.cnf.post_type){t.q.post_type=a;break}t.isLoaded=!0})},toggle_panel(){const t=this;t.$el.querySelector(".wbs-ctrl-bar").classList.toggle("expand"),t.isExpanded=!t.isExpanded}}},n=o,c=a("2877"),i=Object(c["a"])(n,s,l,!1,null,null,null);e["default"]=i.exports}}]);