(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0efca3"],{"9a38":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"wbs-content"},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:!t.isLoaded,expression:"!isLoaded"}],staticClass:"wbs-content-inner",class:{"wb-page-loaded":t.isLoaded}},[s("div",{staticClass:"wbs-main"},[t.isLoaded?s("table",{staticClass:"wbs-form-table"},[s("tr",[s("th",{staticClass:"w8em"},[t._v("功能开关")]),s("td",{staticClass:"info"},[s("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.opt.switch,callback:function(e){t.$set(t.opt,"switch",e)},expression:"opt.switch"}}),s("span",{staticClass:"ml"},[t._v(t._s(1==t.opt.switch?"已启用":"未启用"))])],1)]),s("tr",[s("th",{staticClass:"w8em"},[t._v("古腾堡")]),s("td",[s("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:t.opt.gtb,callback:function(e){t.$set(t.opt,"gtb",e)},expression:"opt.gtb"}}),s("span",{staticClass:"ml"},[t._v(t._s(1==t.opt.gtb?"支持开启":"插件已强制关闭")+"古腾堡")]),s("div",{staticClass:"description mt"},[t._v(" * 当前功能在古腾堡编辑器下无效。需要使用当前功能，请关闭古腾堡编辑器。 ")])],1)])]):t._e(),t.isLoaded?s("el-tabs",{attrs:{"tab-position":t.$cnf.is_mobile?"top":"left"}},[s("el-tab-pane",{attrs:{label:"标签删除"}},[s("table",{staticClass:"wbs-form-table"},[s("tbody",[s("tr",[s("th",{staticClass:"row w8em"},[t._v("常见标签")]),s("td",[s("wb-selector-bar",{attrs:{cnf:t.cnf.tags.normal,opt:t.opt_tags.normal,format:!0},on:{change:function(e){t.opt_tags.normal=e}}})],1)]),s("tr",[s("th",[t._v("表格标签")]),s("td",[s("wb-selector-bar",{attrs:{cnf:t.cnf.tags.table,opt:t.opt_tags.table,format:!0},on:{change:function(e){t.opt_tags.table=e}}})],1)]),s("tr",[s("th",[t._v("列表标签")]),s("td",[s("wb-selector-bar",{attrs:{cnf:t.cnf.tags.list,opt:t.opt_tags.list,format:!0},on:{change:function(e){t.opt_tags.list=e}}})],1)]),s("tr",[s("th",[t._v("其他标签")]),s("td",[s("wb-selector-bar",{attrs:{cnf:t.cnf.tags.other,opt:t.opt_tags.other,format:!0},on:{change:function(e){t.opt_tags.other=e}}})],1)]),s("tr",[s("th",[t._v("自定义")]),s("td",[s("wbs-html-tags-module",{attrs:{tags:t.opt.custom.tags,all:t.allTags,format:!0,rule:"^[a-zA-Z0-9_-]+$"},on:{"set-tags":function(e){t.opt.custom.tags=e}}}),s("div",{staticClass:"description mt"},[t._v(" * 无需输入"),s("code",[t._v("<> & </>")]),t._v("，输入标签名称即可，多个标签以空格或回车键分隔 ")])],1)]),t._e()])])]),s("el-tab-pane",{attrs:{label:"标签属性删除"}},[s("table",{staticClass:"wbs-form-table"},[s("tbody",[s("tr",[s("th",{staticClass:"row w8em"},[t._v("常见标签属性")]),s("td",[s("wb-selector-bar",{attrs:{cnf:t.cnf.attr,opt:t.opt.attr,format:!1},on:{change:function(e){t.opt.attr=e}}})],1)]),s("tr",[s("th",[t._v("自定义")]),s("td",[s("wbs-html-tags-module",{attrs:{tags:t.opt.custom.attr,all:t.allAttr,format:!1,rule:"^[a-zA-Z0-9_-]+$"}}),s("div",{staticClass:"description mt"},[t._v(" * 多个标签属性以空格或者回车键分隔 ")])],1)])])])]),s("el-tab-pane",{attrs:{label:"标签及内容删除"}},[s("table",{staticClass:"wbs-form-table"},[s("tbody",[s("tr",[s("th",{staticClass:"w8em"},[t._v("自定义")]),s("td",[s("wbs-html-tags-module",{attrs:{tags:t.opt.stag,all:t.opt.stag,format:!1,rule:"^[a-zA-Z0-9_-]+$"}}),s("div",{staticClass:"description mt"},[t._v(" * 无需输入"),s("code",[t._v("<> & </>")]),t._v("，输入标签名称即可，多个标签以空格或回车键分隔 ")])],1)])])])]),s("el-tab-pane",{attrs:{label:"优化选项"}},[s("table",{staticClass:"wbs-form-table"},[s("tr",[s("th",{staticClass:"w8em"},[t._v("设置选项")]),s("td",{staticClass:"info"},t._l(t.cnf.format,(function(e,a){return s("el-checkbox",{key:"format"+a,attrs:{"true-label":"1","false-label":"0"},model:{value:t.opt.format[a],callback:function(e){t.$set(t.opt.format,a,e)},expression:"opt.format[k]"}},[t._v(t._s(e))])})),1)])])]),s("el-tab-pane",{attrs:{label:"搜索替换"}},[s("table",{staticClass:"wbs-form-table"},[s("tr",[s("th",{staticClass:"w8em"},[t._v("设置替换项目")]),s("td",[s("ul",t._l(t.opt.txt_replace,(function(e,a){return s("li",{key:"replace"+a,class:{mt:a>0}},[s("el-input",{staticClass:"wbs-input-short wbs-input-underline",attrs:{size:"mini"},model:{value:e.s,callback:function(s){t.$set(e,"s",s)},expression:"r.s"}}),t._v(" 替换 "),s("el-input",{staticClass:"wbs-input-short wbs-input-underline",attrs:{size:"mini"},model:{value:e.r,callback:function(s){t.$set(e,"r",s)},expression:"r.r"}}),s("label",{staticClass:"ml"},[s("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.c,callback:function(s){t.$set(e,"c",s)},expression:"r.c"}})],1),s("el-button",{staticClass:"ml",attrs:{size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(e){return t.item_remove(a)}}})],1)})),0),s("div",{staticClass:"mt"},[s("el-input",{staticClass:"wbs-input-short wbs-input-underline",attrs:{size:"mini",placeholder:"搜索内容"},model:{value:t.new_s,callback:function(e){t.new_s=e},expression:"new_s"}}),t._v(" 替换 "),s("el-input",{staticClass:"wbs-input-short wbs-input-underline",attrs:{size:"mini",placeholder:"替换内容"},model:{value:t.new_r,callback:function(e){t.new_r=e},expression:"new_r"}}),s("el-link",{staticClass:"ml",attrs:{size:"mini"},on:{click:t.addItem}},[s("i",{staticClass:"el-icon-circle-plus-outline"}),s("span",[t._v("增加")])])],1),s("div",{staticClass:"description mt"},[s("ul",[s("li",[t._v(" 搜索替换支持正则表达式，参考如下： ")]),s("li",[t._v(" （1）使用*代表任意查找字符，括号(匹配内容)可在替换内容用$1引用。搜索填写 "),s("code",[t._v('<div class="post-title">(*)</div>')]),t._v(" 替换填写 "),s("code",[t._v("<h1>$1</h1>")])]),s("li",[t._v(" （2）"),s("code",[t._v("<h4>")]),t._v(" 替换 "),s("code",[t._v("<strong>")]),t._v("；则搜索填写 "),s("code",[t._v("<(/?)h4")]),t._v(" 替换填写 "),s("code",[t._v("<$1strong")])]),s("li",[t._v(" （3）"),s("code",[t._v("wp-content/uploads/年/月/")]),t._v(" 替换 "),s("code",[t._v("wp-content/uploads/年-月/")]),t._v(" 搜索填写 "),s("code",[t._v("wp-content/uploads/(\\d{4})/(\\d{2})/")]),t._v(" 替换填写 "),s("code",[t._v("wp-content/uploads/$1-$2/")])])])])])])])])],1):t._e(),s("wb-prompt",{directives:[{name:"show",rawName:"v-show",value:t.isLoaded,expression:"isLoaded"}],staticClass:"mt"})],1),t.$cnf.is_pro?t._e():s("wbs-more-sources"),s("wbs-ctrl-bar",{on:{submit:t.updateData}})],1)])},n=[],l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"selector-bar"},[s("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:t.allToggle},model:{value:t.selectedAll,callback:function(e){t.selectedAll=e},expression:"selectedAll"}},[t._v("全选")]),s("el-checkbox-group",{on:{change:t.updateSelected},model:{value:t.selectedItems,callback:function(e){t.selectedItems=e},expression:"selectedItems"}},t._l(t.cnf,(function(e,a){return s("el-checkbox",{key:a,attrs:{label:e}},[s("span",{domProps:{innerHTML:t._s(t.displayFormat(e))}})])})),1)],1)},o=[],i={name:"wbSelectorBar",props:{cnf:Array,opt:Array,format:Boolean},data(){return{selectedAll:!1,selectedItems:this.opt,isIndeterminate:!0}},mounted(){this.selectedAll=this.opt.length===this.cnf.length,this.isIndeterminate=this.opt.length!==this.cnf.length},methods:{allToggle(t){this.selectedItems=t?this.cnf:[],this.isIndeterminate=!1,this.$emit("change",this.selectedItems)},updateSelected(t){let e=t.length;this.selectedAll=e===this.cnf.length,this.isIndeterminate=e>0&&e<this.cnf.length,this.$emit("change",this.selectedItems)},displayFormat(t){return this.format?"&lt;"+t+"&gt;":t}}},c=i,r=s("2877"),u=Object(r["a"])(c,l,o,!1,null,null,null),p=u.exports,d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("label",{staticClass:"wb-tags-ctrl"},[t.taglist.length?s("div",{staticClass:"tag-items"},t._l(t.taglist,(function(e,a){return s("div",{key:"tag"+a,staticClass:"tag-item"},[s("span",{domProps:{innerHTML:t._s(t.displayFormat(e))}}),s("a",{staticClass:"del",attrs:{"data-del-val":e},on:{click:function(e){return t.delItem(a)}}})])})),0):t._e(),s("input",{directives:[{name:"model",rawName:"v-model",value:t.cur_input,expression:"cur_input"}],staticClass:"wb-tag-input",attrs:{type:"text",placeholder:"以空格或回车分隔"},domProps:{value:t.cur_input},on:{keyup:t.wbTagInput,input:function(e){e.target.composing||(t.cur_input=e.target.value)}}})])},m=[],_={name:"wbsHtmlTags",props:{tags:Array,all:Array,rule:String,format:Boolean},data:function(){return{cur_input:"",keycode:null}},created:function(){},methods:{wbTagInput:function(t){var e=this,s=t.keyCode,a=[8,32,27,37,38,39,40];32===s&&(e.cur_input=e.cur_input.trim()),8===s?(e.keycode++,e.keycode>2&&(e.tags.pop(),e.$wbui.toast("已移除"),e.keycode=null)):e.keycode=null;const n=new RegExp(e.rule);if(!a.includes(s)&&!n.test(e.cur_input))return e.cur_input="",e.$wbui.toast("请确认格式");32!==s&&13!==s||e.wbTagPush()},wbTagPush:function(t){var e=this;return""!=e.cur_input&&(e.all.indexOf(e.cur_input.trim())>-1||e.taglist.indexOf(e.cur_input.trim())>-1?(e.$wbui.toast("已存在"),e.cur_input="",!1):(e.tags.push(e.cur_input),e.$emit("set-tags",e.tags),e.cur_input="",!1))},delItem:function(t){var e=this;e.tags.splice(t,1),e.$wbui.toast("已移除")},displayFormat:function(t){return this.format?"&lt;"+t+"&gt;":t}},computed:{taglist:function(){var t=this.tags||[];return t}}},h=_,b=Object(r["a"])(h,d,m,!1,null,null,null),f=b.exports,v={name:"MagicPostDownload",components:{"wb-selector-bar":p,"wbs-html-tags-module":f},data(){const t=this;return{wb_cnf:t.$cnf,formChanged:0,isLoaded:!1,isPro:t.$cnf.is_pro,new_s:"",new_r:"",cnf:{},opt:{tags:{},attr:{},format:{},custom:{}},opt_tags:{}}},created(){this.loadData()},computed:{allTags(){const t=this;let e=[];const s=t.cnf.tags;for(let a in s)e=e.concat(s[a]);return e},allAttr(){const t=this;return t.cnf.attr}},methods:{item_remove(t){const e=this;return e.opt.txt_replace.splice(t,1),!1},addItem(){const t=this;if(!t.new_s)return!1;t.opt.txt_replace.push({s:t.new_s,r:t.new_r,c:0}),t.new_s="",t.new_r=""},optTags(){const t=this,e=t.cnf.tags,s={};for(let a in e)s[a]=e[a].filter((function(e){return t.opt.tags&&t.opt.tags.includes(e)}));return s},loadData(){console.log("clean loadData");const t=this;t.$api.getData({_ajax_nonce:t.$cnf._ajax_nonce,action:t.$cnf.action.act,op:"cht_setting"}).then(e=>{t.cnf=e["cnf"],t.opt=e["opt"],t.opt_tags=t.optTags(),t.$nextTick(()=>{t.formChanged=1}),t.isLoaded=!0})},updateData(t){const e=this;let s=e.opt,a=[];for(let l in e.opt_tags)a=a.concat(e.opt_tags[l]);s.tags=a,s.re_txt=JSON.stringify(s.txt_replace);const n={_ajax_nonce:e.$cnf._ajax_nonce,action:e.$cnf.action.act,op:"cht_update",opt:s};e.$api.saveData(n).then(s=>{e.$wbui.toast("设置保存成功"),e.formChanged=1,t&&t()})}},watch:{opt:{handler(){this.formChanged++},deep:!0}},beforeRouteLeave(t,e,s){const a=this;a.formChanged>1?a.$wbui.open({content:"您修改的设置尚未保存，确定离开此页面吗？",btn:["保存并离开","放弃修改"],yes(){return s(!1),a.updateData((function(){s()})),!1},no(){return s(),!1}}):s()}},g=v,w=Object(r["a"])(g,a,n,!1,null,null,null);e["default"]=w.exports}}]);